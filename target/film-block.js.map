{"version":3,"file":"film-block.js","names":["movieConteiner","document","getElementById","innerHTML","getKinopoiskApiData","url","fetch","method","headers","getTopFilms","getFilmById","id","renderBlockFilms","posterUrl","nameRu","itemWrap","createElement","classList","add","itemBg","shadow","itemDescr","className","append","imgBg","alt","src","width","descrHead","descrTxt","innerText","getBlockFilmsData","answer","json","data","request","filmsLayout","Map","films","forEach","film","posterUrlPreview","filmConteiner","description","set","filmId","push","Promise","resolve","reject","dataFilmId","textContent","all","filmsLayouts","values","slice","console","error"],"sources":["../js/film-block.js"],"sourcesContent":["const movieConteiner = document.getElementById('movie__container');\r\nmovieConteiner.innerHTML = \"\";\r\n\r\nconst getKinopoiskApiData = (url) => {\r\n    return fetch(url, {\r\n        method: 'GET',\r\n        headers: {\r\n            'X-API-KEY': 'a74abe5b-98c9-4b94-ad76-7418b4c4f991',\r\n            'Content-Type': 'application/json'\r\n        }\r\n    });   \r\n};\r\nconst getTopFilms = () => {\r\n    return getKinopoiskApiData('https://kinopoiskapiunofficial.tech/api/v2.2/films/top?type=TOP_100_POPULAR_FILMS&page=1')\r\n};\r\nconst getFilmById = (id) => {\r\n    return getKinopoiskApiData(`https://kinopoiskapiunofficial.tech/api/v2.2/films/${id}`)\r\n};\r\n\r\nfunction renderBlockFilms(posterUrl, nameRu){\r\n    const itemWrap = document.createElement('div');\r\n    itemWrap.classList.add('movie__item');\r\n    const itemBg = document.createElement('div');\r\n    itemBg.classList.add('movie__item-bg');\r\n    const shadow = document.createElement('div');\r\n    shadow.classList.add('movie__item-shadow');\r\n    const itemDescr = document.createElement('a');\r\n    itemDescr.className ='movie__item-descr link__white';\r\n    itemWrap.append(itemBg,shadow,itemDescr);\r\n    const imgBg = document.createElement('img');\r\n    imgBg.alt = 'постер_фильма';\r\n    imgBg.src = posterUrl;\r\n    imgBg.width = '283px';\r\n    itemBg.append(imgBg);\r\n    const descrHead = document.createElement('div');\r\n    const descrTxt = document.createElement('div');\r\n    descrHead.classList.add('descr__head');\r\n    descrHead.innerText = nameRu;\r\n    descrTxt.classList.add('descr__text');\r\n    descrTxt.innerText = '..loading..';\r\n    itemDescr.append(descrHead,descrTxt);\r\n    return [itemWrap, descrTxt]\r\n}\r\n\r\nconst getBlockFilmsData = async () => {\r\n    try {\r\n        const answer = await getTopFilms();\r\n        const data = await answer.json();\r\n        const request = [];\r\n        const filmsLayout = new Map();\r\n\r\n        data.films.forEach(async (film) => {\r\n            const [filmConteiner, description] = renderBlockFilms(film.posterUrlPreview,film.nameRu);\r\n            filmsLayout.set(film.filmId, filmConteiner);\r\n\r\n            request.push(new Promise(async (resolve,reject) =>{\r\n                   try{\r\n                        const answer = await getFilmById(film.filmId);\r\n                        const dataFilmId = await answer.json();\r\n                        description.textContent = dataFilmId.description;\r\n                        if (!dataFilmId.description) {\r\n                            filmsLayout.delete(film.filmId)\r\n                        };\r\n                   } catch (error) {\r\n                   }\r\n                        \r\n                   resolve();\r\n                }));\r\n        });\r\n        await Promise.all(request);\r\n        const filmsLayouts = [...filmsLayout.values()].slice(0,9);\r\n        movieConteiner.append(...filmsLayouts);\r\n    } catch(error) {\r\n        console.error(error)\r\n    }\r\n};\r\n// getBlockFilmsData();\r\n"],"mappings":"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"}